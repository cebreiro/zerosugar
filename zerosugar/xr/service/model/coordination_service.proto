syntax = "proto3";

package zerosugar.xr.service;

service CoordinationService
{
    rpc GetName (GetNameParam) returns (GetNameResult);

    rpc RequestSnowflakeKey (RequestSnowflakeKeyParam) returns (RequestSnowflakeKeyResult);
    rpc ReturnSnowflakeKey (ReturnSnowflakeKeyParam) returns (ReturnSnowflakeKeyResult);

    rpc AddPlayer (AddPlayerParam) returns (AddPlayerResult);
}

enum CoordinationServiceErrorCode
{
    Coordination_error_none = 0;
    Coordination_error_internal_error = 1;

    request_snowflake_key_error_out_of_pool = 30001;
    return_snowflake_key_error_invalid_key = 40001;
}

message GetNameParam
{
}

message GetNameResult
{
    string name = 1;
}

message RequestSnowflakeKeyParam
{
    string requester = 1;
}

message RequestSnowflakeKeyResult
{
    CoordinationServiceErrorCode error_code = 1;
    int32 snowflake_key = 2;
}

message ReturnSnowflakeKeyParam
{
    string requester = 1;
    int32 snowflake_key = 2;
}

message ReturnSnowflakeKeyResult
{
    CoordinationServiceErrorCode error_code = 1;
}

message AddPlayerParam
{
    string authentication_token = 1;
    int64 account_id = 2;
    int64 character_id = 3;
    int32 zone_id = 4;
}

message AddPlayerResult
{
    CoordinationServiceErrorCode error_code = 1;

    string ip = 2;
    int32 port = 3;
}
